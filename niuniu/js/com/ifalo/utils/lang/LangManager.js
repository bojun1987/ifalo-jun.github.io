var com,__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])})(t,e)};return function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}}();!function(n){!function(n){!function(n){!function(n){var t=function(n){function t(){var t=n.call(this)||this;return t._numComplete=0,t._langNames=[],t._langXmls=[],t}return __extends(t,n),Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t)},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._langRegExp=null,this._langXmls.length=0,this._langXmls=null,this._langNames.length=0,this._langNames=null,t._instance=null},t.prototype.onMultiComplete=function(){this._numComplete++,this._numComplete==this._langXmls.length&&this.event(Laya.Event.COMPLETE)},t.prototype.loadLangNames=function(n){var t=this;this._langNames.length=0,Laya.loader.load(n,Laya.Handler.create(this,function(n,e){for(var a="",r=e.getElementsByTagName("lang"),o=0,l=r.length;o<l;++o){var s=r[o].getAttribute("code"),i=r[o].getAttribute("name"),g=r[o].textContent;t._langNames.push({code:s,name:i,msg:g}),a+=(0==a.length?"":"|")+s+"/"}Laya.loader.clearRes(n),t._langRegExp=new RegExp(a,"g"),t.event(Laya.Event.LOADED)},[n]))},t.prototype.getLangXML=function(n){for(var t=this._langXmls.length-1;t>=0;--t){var e=this._langXmls[t];if(e.langXml instanceof n)return e.langXml}throw new Error("未搜尋到指定的語系資料")},t.prototype.addLangXML=function(n,t){if(void 0===t&&(t="res/langs/lang"),0==this._langNames.length)throw new Error("請先設置語系編碼與名稱 loadLangNames()，再加入語系資料");if(0==this._langXmls.length&&this._langCode)throw new Error("請於設定語系 setLangCode() 之前加入語系資料");for(var e=this._langXmls.length-1;e>=0;--e){if(this._langXmls[e].langXml instanceof n)throw new Error("不支援設置重複的語系資料")}var a=new n;this._langXmls.push({langXml:a,path:t})},t.prototype.removeLangXML=function(n){for(var t=this._langXmls.length-1;t>=0;--t){this._langXmls[t].langXml instanceof n&&this._langXmls.splice(t,1)}},t.prototype.setLangCode=function(n){if(0==this._langNames.length)throw new Error("請先設置語系編碼與名稱 loadLangNames()，並加入語系資料");for(var t=!1,e=this._langNames.length-1;e>=0;--e)if(this._langNames[e].code==n){t=!0;break}if(!t)throw new Error("無法設置未預定的語系編碼");this._langCode=n,this._numComplete=0;for(e=this._langXmls.length-1;e>=0;--e){var a=this._langXmls[e];a.langXml.setPath(a.path+"_"+this.langCode+".xml"),a.langXml.once(Laya.Event.COMPLETE,this,this.onMultiComplete)}},t.prototype.setPreLangOn=function(n,e){void 0===e&&(e=!0),e&&(this._rootName=n.name);for(var a=n.numChildren-1;a>=0;--a){var r=n.getChildAt(a);if(r.hasOwnProperty("prompt")||r.hasOwnProperty("label")||r.hasOwnProperty("text"))for(var o=0,l=this._langXmls.length;o<l;++o){var s=t.instance._langXmls[o].langXml.getPreText(this._rootName,r.parent.name,r.name);s&&(r.hasOwnProperty("prompt")?r.prompt=s:r.hasOwnProperty("label")?r.label=s:r.text=s)}r.hasOwnProperty("skin")&&r.skin&&(r.skin=r.skin.replace(this._langRegExp,this._langCode+"/")),this.setPreLangOn(r,!1)}},Object.defineProperty(t.prototype,"langCode",{get:function(){return this._langCode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"langIndex",{get:function(){for(var n=this._langNames.length-1;n>=0;--n)if(this._langNames[n].code==this._langCode)return n;return-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"langNames",{get:function(){return this._langNames.concat()},enumerable:!0,configurable:!0}),t}(Laya.EventDispatcher);n.LangManager=t}(n.lang||(n.lang={}))}(n.utils||(n.utils={}))}(n.ifalo||(n.ifalo={}))}(com||(com={}));